!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).G=e.G||{},e.G.HTMLRenderer={}),e.window.G)}(this,(function(e,t){"use strict";var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)};var n={}.toString,a=function(e,t){return n.call(e)==="[object "+t+"]"},i=function(e){return a(e,"Number")},o=function(){function e(){}return e.prototype.joinTransformMatrix=function(e){return"matrix(".concat([e[0],e[1],e[4],e[5],e[12],e[13]].join(","),")")},e.prototype.apply=function(r){var n=this,a=r.camera,i=r.renderingContext,o=r.renderingService;this.context=r;var s=i.root.ownerDocument.defaultView,l=function(e,t){t.style.transform=n.joinTransformMatrix(e.getWorldTransform())},c=function(e){var r=e.target;if(r.nodeName===t.Shape.HTML){n.$camera||(n.$camera=n.createCamera(a));var i=n.getOrCreateEl(r);n.$camera.appendChild(i);var o=r.ownerDocument.documentElement.attributes;Object.keys(o).forEach((function(e){i.style[e]=o[e]})),Object.keys(r.attributes).forEach((function(e){n.updateAttribute(e,r)})),l(r,i),t.runtime.nativeHTMLMap.set(i,r)}},d=function(e){var r=e.target;if(r.nodeName===t.Shape.HTML&&n.$camera){var a=n.getOrCreateEl(r);a&&(a.remove(),t.runtime.nativeHTMLMap.delete(a))}},p=function(e){var r=e.target;r.nodeName===t.Shape.HTML&&n.updateAttribute(e.attrName,r)},u=function(e){var r=e.target;if(r.nodeName===t.Shape.HTML){var a=n.getOrCreateEl(r);l(r,a)}},f=function(){if(n.$camera){var e=n.context.config,t=e.height;n.$camera.style.width="".concat(e.width||0,"px"),n.$camera.style.height="".concat(t||0,"px")}};o.hooks.init.tap(e.tag,(function(){s.addEventListener(t.CanvasEvent.RESIZE,f),s.addEventListener(t.ElementEvent.MOUNTED,c),s.addEventListener(t.ElementEvent.UNMOUNTED,d),s.addEventListener(t.ElementEvent.ATTR_MODIFIED,p),s.addEventListener(t.ElementEvent.BOUNDS_CHANGED,u)})),o.hooks.endFrame.tap(e.tag,(function(){n.$camera&&i.renderReasons.has(t.RenderReason.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(a.getOrthoMatrix()))})),o.hooks.destroy.tap(e.tag,(function(){n.$camera&&n.$camera.remove(),s.removeEventListener(t.CanvasEvent.RESIZE,f),s.removeEventListener(t.ElementEvent.MOUNTED,c),s.removeEventListener(t.ElementEvent.UNMOUNTED,d),s.removeEventListener(t.ElementEvent.ATTR_MODIFIED,p),s.removeEventListener(t.ElementEvent.BOUNDS_CHANGED,u)}))},e.prototype.getId=function(e){return e.id||"g-html-"+e.entity},e.prototype.createCamera=function(e){var t,r=(t=this.context.config).document,n=t.width,a=t.height,i=this.context.contextService.getDomElement(),o=i.parentNode;if(o){var s="g-canvas-camera",l=o.querySelector("#"+s);if(!l){var c=(r||document).createElement("div");l=c,c.id=s,c.style.position="absolute",c.style.left="".concat(i.offsetLeft||0,"px"),c.style.top="".concat(i.offsetTop||0,"px"),c.style.transformOrigin="left top",c.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),c.style.overflow="hidden",c.style.pointerEvents="none",c.style.width="".concat(n||0,"px"),c.style.height="".concat(a||0,"px"),o.appendChild(c)}return l}return null},e.prototype.getOrCreateEl=function(e){var t=this.context.config.document,r=this.getId(e),n=this.$camera.querySelector("#"+r);return n||(n=(t||document).createElement("div"),e.parsedStyle.$el=n,n.id=r,e.name&&n.setAttribute("name",e.name),e.className&&(n.className=e.className),n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(e.getWorldTransform())),n},e.prototype.updateAttribute=function(e,r){var n=this.getOrCreateEl(r);switch(e){case"innerHTML":var o=r.parsedStyle.innerHTML;a(o,"String")?n.innerHTML=o:(n.innerHTML="",n.appendChild(o));break;case"transformOrigin":var s=r.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(s[0].value," ").concat(s[1].value);break;case"width":if(t.runtime.enableCSSParsing){var l=r.computedStyleMap().get("width");n.style.width=""+l}else{n.style.width=i(l=r.parsedStyle.width)?"".concat(l,"px"):""+l}break;case"height":if(t.runtime.enableCSSParsing){var c=r.computedStyleMap().get("height");n.style.height=""+c}else{n.style.height=i(c=r.parsedStyle.height)?"".concat(c,"px"):""+c}break;case"zIndex":n.style["z-index"]="".concat(r.parsedStyle.zIndex);break;case"visibility":n.style.visibility=r.parsedStyle.visibility;break;case"pointerEvents":n.style.pointerEvents=r.parsedStyle.pointerEvents;break;case"opacity":n.style.opacity="".concat(r.parsedStyle.opacity);break;case"fill":var d=r.parsedStyle.fill,p="";t.isCSSRGB(d)?p=d.isNone?"transparent":r.getAttribute("fill"):Array.isArray(d)?p=r.getAttribute("fill"):t.isPattern(d),n.style.background=p;break;case"stroke":var u=r.parsedStyle.stroke,f="";t.isCSSRGB(u)?f=u.isNone?"transparent":r.getAttribute("stroke"):Array.isArray(u)?f=r.getAttribute("stroke"):t.isPattern(u),n.style["border-color"]=f,n.style["border-style"]="solid";break;case"lineWidth":n.style["border-width"]="".concat(r.parsedStyle.lineWidth||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":n.style.filter=r.style.filter}},e.tag="HTMLRendering",e}(),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="html-renderer",t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+t+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.init=function(){this.addRenderingPlugin(new o)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(t.AbstractRendererPlugin);e.Plugin=s}));
//# sourceMappingURL=index.umd.min.js.map
